/home/j-zhong/anaconda3/lib/python3.8/site-packages/torch/nn/modules/rnn.py:739: UserWarning: RNN module weights are not part of single contiguous chunk of memory. This means they need to be compacted at every call, possibly greatly increasing memory usage. To compact weights again call flatten_parameters(). (Triggered internally at  /pytorch/aten/src/ATen/native/cudnn/RNN.cpp:775.)
  result = _VF.gru(input, hx, self._flat_weights, self.bias, self.num_layers,
/home/j-zhong/work_place/Bi-Level-Actor-Critic-with-F/algorithm/DPPO.py:90: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  torch.tensor(follower_action).detach().to(self.device))
episode--------------------  0
Episode:  0
---------------------------training!
compute
add
name leader
name, p self_attention.in_proj_weight Parameter containing:
tensor([[-0.1075, -0.0705,  0.0610,  ...,  0.0841,  0.0613, -0.0861],
        [ 0.1113,  0.0712,  0.1031,  ..., -0.0469, -0.0204,  0.0638],
        [ 0.1275,  0.0849, -0.0780,  ..., -0.0305, -0.0731,  0.0596],
        ...,
        [-0.1224, -0.0447,  0.0175,  ...,  0.0178, -0.0802,  0.0022],
        [ 0.0352, -0.0505,  0.0083,  ...,  0.1421,  0.0717,  0.0547],
        [-0.0692,  0.1285, -0.1080,  ...,  0.1252,  0.0140,  0.0897]],
       device='cuda:0', requires_grad=True)
name, p self_attention.in_proj_bias Parameter containing:
tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       device='cuda:0', requires_grad=True)
name, p self_attention.out_proj.weight Parameter containing:
tensor([[-0.0330,  0.0361,  0.0796,  ..., -0.0907,  0.0467,  0.1238],
        [ 0.0491,  0.0488,  0.0087,  ...,  0.0784, -0.1227, -0.1218],
        [-0.0454,  0.1070,  0.0991,  ...,  0.0484, -0.0559,  0.0608],
        ...,
        [ 0.0597,  0.1200,  0.0480,  ..., -0.1200, -0.0056, -0.0223],
        [ 0.1007,  0.0712, -0.1248,  ..., -0.0893, -0.0424,  0.0759],
        [ 0.0318,  0.1186,  0.0423,  ...,  0.0109, -0.0160,  0.0704]],
       device='cuda:0', requires_grad=True)
name, p self_attention.out_proj.bias Parameter containing:
tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       device='cuda:0', requires_grad=True)
name, p gru.weight_ih_l0 Parameter containing:
tensor([[-0.0361, -0.0731, -0.1199,  ..., -0.0445, -0.0971,  0.1186],
        [-0.0750, -0.0643, -0.0332,  ..., -0.0010,  0.0978,  0.0413],
        [ 0.0323, -0.0226, -0.0487,  ...,  0.1152, -0.0445,  0.0264],
        ...,
        [-0.0434, -0.0432, -0.0900,  ..., -0.0631, -0.1079, -0.0446],
        [ 0.0338,  0.0551,  0.1203,  ...,  0.1110, -0.0713,  0.0547],
        [-0.1156, -0.0292, -0.0482,  ..., -0.0930,  0.0501,  0.0655]],
       device='cuda:0', requires_grad=True)
name, p gru.weight_hh_l0 Parameter containing:
tensor([[-0.0261, -0.0060, -0.1143,  ...,  0.0535, -0.0466, -0.0372],
        [ 0.0363,  0.0830,  0.0896,  ..., -0.1193,  0.0616,  0.0464],
        [-0.1238, -0.0253,  0.0500,  ...,  0.0028,  0.0412,  0.0791],
        ...,
        [-0.0113, -0.0671,  0.0931,  ...,  0.1195,  0.0038,  0.0643],
        [ 0.0388, -0.0920,  0.0756,  ...,  0.1030, -0.0546,  0.0745],
        [ 0.0363,  0.0310,  0.0463,  ..., -0.0071, -0.1231, -0.0024]],
       device='cuda:0', requires_grad=True)
name, p gru.bias_ih_l0 Parameter containing:
tensor([ 0.0947,  0.0305, -0.0020, -0.0898, -0.1009,  0.0615, -0.0277, -0.0975,
         0.0601,  0.1039, -0.0266, -0.0489, -0.0348, -0.0938, -0.0569,  0.1240,
        -0.0988,  0.1069,  0.0911,  0.0441, -0.0139,  0.0875, -0.0619,  0.0419,
        -0.0168,  0.0285,  0.1022,  0.0127, -0.0805, -0.1100,  0.0264, -0.0952,
        -0.0890,  0.0930, -0.1041,  0.0998,  0.0738, -0.1232, -0.1122,  0.0443,
        -0.1172,  0.0098,  0.0335,  0.0948, -0.0213,  0.0023, -0.0523,  0.1111,
        -0.1073,  0.0742, -0.0022, -0.0641, -0.0070, -0.0071,  0.0381,  0.0700,
         0.0042, -0.1088, -0.0184,  0.0657, -0.1175, -0.0212,  0.1171, -0.1207,
         0.0701,  0.1177, -0.0646, -0.0457, -0.1085,  0.0594, -0.0972,  0.1048,
         0.0479, -0.0065,  0.0624,  0.0607,  0.0116,  0.0792,  0.0395, -0.1025,
        -0.0356, -0.0560,  0.1171,  0.0688,  0.0323, -0.0802,  0.0933, -0.0704,
        -0.0633, -0.0567, -0.0674,  0.0060, -0.1242, -0.0764,  0.0624,  0.0820,
         0.1217, -0.0236, -0.0503, -0.0829, -0.0914, -0.0971, -0.0171,  0.0066,
        -0.0828,  0.0497,  0.0033,  0.0700, -0.0731, -0.0034,  0.0514, -0.0338,
        -0.0052, -0.0857,  0.0136, -0.0444, -0.0034,  0.0046,  0.0482, -0.0647,
        -0.0687,  0.1001, -0.0957, -0.0820,  0.0439,  0.0040,  0.1031,  0.0567,
        -0.0156,  0.0153, -0.0961, -0.0827,  0.1004,  0.1024, -0.0114, -0.1058,
        -0.0870,  0.0221, -0.0859, -0.1234,  0.0910, -0.0379, -0.0991,  0.0027,
         0.1088,  0.0992,  0.0864, -0.0597, -0.0128, -0.0787,  0.0387,  0.0836,
        -0.0490, -0.1118,  0.1117,  0.0766, -0.0584, -0.0294,  0.0625,  0.0090,
        -0.1057,  0.0699, -0.0558,  0.1111,  0.0591,  0.0013,  0.0797,  0.0266,
        -0.0816, -0.1239,  0.0274,  0.0847,  0.0623, -0.0575,  0.0910,  0.0724,
        -0.0478,  0.1017, -0.0331,  0.0618, -0.0069, -0.0386, -0.0336, -0.0297,
        -0.0810, -0.1047,  0.0625, -0.1156,  0.1096, -0.0723, -0.0382, -0.0214],
       device='cuda:0', requires_grad=True)
name, p gru.bias_hh_l0 Parameter containing:
tensor([ 0.1115,  0.0911,  0.0305,  0.0322, -0.0668, -0.0744, -0.1243,  0.0196,
        -0.1126,  0.1124,  0.0088, -0.0983, -0.0846, -0.0947,  0.1136,  0.0321,
        -0.1038, -0.0552, -0.1135,  0.0144, -0.0505, -0.1098, -0.0138,  0.0021,
         0.0183,  0.0256, -0.0687, -0.1107, -0.1117, -0.0109, -0.0457, -0.0629,
         0.1125, -0.0496, -0.0113,  0.1145,  0.0456,  0.1217, -0.0807, -0.0072,
         0.0787,  0.0453, -0.0077,  0.1237, -0.1057,  0.0458,  0.0285,  0.1030,
        -0.0139, -0.0803,  0.0792, -0.0609, -0.0149,  0.0294, -0.1131, -0.1177,
         0.0192, -0.0439,  0.0936,  0.0078, -0.1026,  0.0065,  0.0387,  0.0387,
         0.1201, -0.0448,  0.0021, -0.0711,  0.0066, -0.0076,  0.1139, -0.0750,
        -0.1108,  0.0378, -0.0947, -0.1177,  0.0012,  0.0852,  0.0825, -0.0374,
        -0.1153,  0.1080, -0.0644, -0.1071, -0.0179, -0.0857,  0.1035, -0.0808,
        -0.0574, -0.0205,  0.0226, -0.0549, -0.0762, -0.0716,  0.1114,  0.0361,
        -0.0500,  0.0572,  0.0958, -0.0399,  0.0866,  0.0213,  0.0228,  0.0801,
         0.0077, -0.1183,  0.0665,  0.0869, -0.0694, -0.0124,  0.0091, -0.0743,
         0.1062,  0.1134,  0.0922,  0.0932,  0.1180,  0.0027, -0.0141,  0.0209,
        -0.1110,  0.0406, -0.0488, -0.0173, -0.0660,  0.0599,  0.0074,  0.0713,
        -0.0151, -0.0178, -0.0391, -0.0112,  0.0582,  0.0669,  0.0094, -0.0499,
         0.0044, -0.0961,  0.0496,  0.0703, -0.0777,  0.0447, -0.0092,  0.0451,
        -0.0040,  0.1200,  0.0579,  0.0424,  0.0942,  0.0534,  0.0777,  0.1002,
        -0.0708, -0.0402,  0.0491, -0.0507, -0.0456, -0.0242, -0.1062,  0.1010,
         0.0312,  0.1103, -0.0419,  0.1025,  0.1238,  0.0889,  0.0686, -0.0418,
         0.1017,  0.0757,  0.0909, -0.0676,  0.0831, -0.0289,  0.0846,  0.0645,
         0.0201,  0.1043,  0.0914,  0.0223, -0.0643, -0.0667,  0.0973, -0.0610,
         0.0907,  0.0970,  0.0890, -0.0929,  0.0680,  0.0739,  0.0741, -0.1118],
       device='cuda:0', requires_grad=True)
name, p linear1.weight Parameter containing:
tensor([[-0.0086,  0.3935, -0.3563,  ...,  0.4720, -0.2926, -0.0760],
        [-0.1502, -0.1047,  0.1957,  ..., -0.2035,  0.1654, -0.1701],
        [ 0.1510, -0.0379, -0.2617,  ..., -0.3700,  0.4021,  0.2357],
        ...,
        [ 0.1065,  0.2638, -0.0975,  ...,  0.3103,  0.2271,  0.2272],
        [ 0.1467, -0.0698, -0.0164,  ...,  0.2705,  0.3162, -0.2028],
        [-0.1438,  0.0153, -0.0638,  ..., -0.1065, -0.2498,  0.0593]],
